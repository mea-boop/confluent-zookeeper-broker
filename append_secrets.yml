[Unit]
Description=Confluent Kafka Broker
Documentation=https://docs.confluent.io
After=network-online.target zookeeper.service
Wants=network-online.target
Requires=zookeeper.service

[Service]
Type=simple
User={{ kafka_user }}
Group={{ kafka_group }}
ExecStart={{ kafka_home }}/bin/kafka-server-start {{ kafka_config_dir }}/server.properties
ExecStop={{ kafka_home }}/bin/kafka-server-stop
Restart=on-failure
RestartSec=10
LimitNOFILE=100000

# JMX and Prometheus JMX Exporter
Environment="KAFKA_JMX_OPTS={{ kafka_jmx_opts }}"
Environment="KAFKA_HEAP_OPTS=-Xmx6g -Xms6g"
Environment="LOG_DIR=/var/log/kafka"

StandardOutput=journal
StandardError=journal
SyslogIdentifier=confluent-kafka

[Install]
WantedBy=multi-user.target
